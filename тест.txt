Домашние задания курса OTUS "MS SQL Server разработчик".

Группа 2019-07.


апрапрапрапра





-- 3. 
	SELECT 
      [InvoiceDate],
	  DATENAME(MONTH, ([InvoiceDate])) as MOTHS,
	  DATEPART (QUARTER, ([InvoiceDate])) AS KVARTAL,
	   CASE
			WHEN MONTH ([InvoiceDate]) between 1 and 4  THEN '1'
			WHEN MONTH ([InvoiceDate])between 5 and 8  THEN '2'
			WHEN MONTH ([InvoiceDate]) between 9 and 12 THEN '3'
		END AS KVARTAL
	FROM [Sales].[Invoices] INV
	LEFT JOIN [Sales].[OrderLines] ORL	ON INV.OrderID = ORL.OrderID
	WHERE UnitPrice > 100 OR Quantity > 20
	ORDER BY DATENAME(MONTH, ([InvoiceDate])) ,DATEPART (QUARTER, ([InvoiceDate])),
	 CASE
			WHEN MONTH ([InvoiceDate]) between 1 and 4  THEN '1'
			WHEN MONTH ([InvoiceDate])between 5 and 8  THEN '2'
			WHEN MONTH ([InvoiceDate]) between 9 and 12 THEN '3'
		END
	OFFSET 1000 ROWS FETCH FIRST 100 ROWS ONLY;